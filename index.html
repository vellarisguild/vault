<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIHIA Numerology</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono:wght@400;700&family=Noto+Sans+Thai:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #0a0a0a;
            font-family: 'Noto Sans Mono', monospace;
            color: #f59e0b; /* Amber-500 */
        }
        .terminal {
            background-color: rgba(17, 24, 39, 0.9);
            border: 1px solid #374151;
            backdrop-filter: blur(10px);
        }
        #terminal-input {
            background: none;
            border: none;
            outline: none;
            color: #f59e0b;
            width: 100%;
        }
        .prompt::before {
            content: 'AIHIA:~# ';
            color: #a3e635; /* Lime-400 */
        }
        .user-input {
            color: #60a5fa; /* Blue-400 */
        }
        .cursor {
            display: inline-block;
            background-color: #f59e0b;
            animation: blink 1s step-end infinite;
            width: 10px;
            height: 1.2rem;
            margin-left: 4px;
        }
        @keyframes blink {
            from, to { background-color: transparent; }
            50% { background-color: #f59e0b; }
        }
        .output-line {
            white-space: pre-wrap;
            word-break: break-all;
        }
        .noto-sans-thai { font-family: 'Noto Sans Thai', sans-serif; }
        .ascii-art pre {
            color: #f59e0b;
            letter-spacing: normal;
            font-size: 0.8rem;
            line-height: 1;
        }
        .faq-toggle {
            cursor: pointer;
            background-color: #374151;
            padding: 8px;
            border-radius: 4px;
            margin-top: 1rem;
            transition: background-color 0.3s;
        }
        .faq-toggle:hover {
            background-color: #4b5563;
        }
        .faq-content {
            display: none;
            padding: 1rem;
            margin-top: 0.5rem;
            border-left: 2px solid #f59e0b;
            background-color: rgba(10,10,10,0.5);
        }
    </style>
</head>
<body class="p-4">
    <div id="terminal-container" class="terminal max-w-4xl mx-auto rounded-lg shadow-2xl p-4 md:p-6 min-h-[80vh] flex flex-col">
        <div id="terminal-output" class="flex-grow space-y-2 overflow-y-auto">
            <!-- Output will be dynamically added here -->
        </div>
        <div id="input-line" class="flex items-center mt-4">
            <label for="terminal-input" id="prompt-label" class="prompt"></label>
            <input type="text" id="terminal-input" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
            <span class="cursor"></span>
        </div>
    </div>

    <script>
        // --- DATA & CONFIGURATION ---
        const numberMeanings = {
            1: { archetype: "ไอ้ผู้นำบ้าอำนาจ", quality: "การเริ่มต้น, ความทะเยอทะยาน", summary: "มึงเกิดมาเพื่อสั่ง ไม่ใช่เพื่อตาม... สันดานดิบคือความทะเยอทะยาน อยากเป็นที่หนึ่งเสมอ แต่ระวังอย่าให้ความหยิ่งยโสของมึงทำทุกอย่างพัง" },
            2: { archetype: "ไอ้นักการทูตหน่อมแน้ม", quality: "ความร่วมมือ, ความสมดุล", summary: "มึงเกลียดความขัดแย้ง ชอบประนีประนอม... พรสวรรค์คือการเชื่อมคน แต่ถ้าขี้ขลาดเกินไปก็จะกลายเป็นแค่พรมเช็ดเท้าให้คนอื่น" },
            3: { archetype: "ไอ้ตัวโจ๊กชอบเรียกร้องความสนใจ", quality: "การแสดงออก, ความสร้างสรรค์", summary: "มึงมีพรสวรรค์ในการพูดจาหว่านล้อม สร้างสรรค์... แต่ถ้าไม่รู้จักควบคุม ก็จะกลายเป็นพวกดีแต่พูด น้ำท่วมทุ่ง แต่หาแก่นสารไม่ได้" },
            4: { archetype: "ไอ้กรรมกรบ้างาน", quality: "ความมั่นคง, การสร้างรากฐาน", summary: "มึงคือรากฐานที่มั่นคง มีวินัยและอดทน... แต่มึงก็ดื้อรั้นหัวแข็งเหมือนควาย ไม่รู้จักยืดหยุ่นจนบางทีโอกาสดีๆ ก็หลุดลอยไป" },
            5: { archetype: "ไอ้คนพเนจรไร้ราก", quality: "อิสรภาพ, การเปลี่ยนแปลง", summary: "มึงรักอิสระเหนือสิ่งอื่นใด เกลียดการผูกมัด... ชีวิตมึงน่าตื่นเต้นดี แต่ถ้าไม่มีหลักแหล่งเลย สุดท้ายมึงก็จะกลายเป็นคนว่างเปล่าไร้แก่นสาร" },
            6: { archetype: "ไอ้พ่อพระ/แม่พระจอมบงการ", quality: "ความรับผิดชอบ, การดูแล", summary: "มึงเกิดมาเพื่อดูแลคนอื่น แบกรับภาระชาวบ้าน... มันดูดี แต่ลึกๆ แล้วมึงก็อยากควบคุมทุกอย่างให้เป็นไปตามใจต้องการ" },
            7: { archetype: "ไอ้ฤาษีขี้สงสัย", quality: "การวิเคราะห์, การค้นหาความจริง", summary: "มึงเป็นนักคิด นักวิเคราะห์ ชอบค้นหาความจริง... แต่มึงก็ชอบแยกตัวออกจากสังคมจนกลายเป็นคนประหลาดที่ไม่มีใครเข้าใจ" },
            8: { archetype: "ไอ้ทุนนิยมสามานย์", quality: "อำนาจ, ความสำเร็จทางวัตถุ", summary: "มึงเกิดมาเพื่อกอบโกยอำนาจและเงินทอง... มึงเก่งเรื่องธุรกิจ การจัดการ แต่ถ้าโลภมากเกินไป มึงก็จะเหยียบหัวทุกคนเพื่อไปให้ถึงเป้าหมาย" },
            9: { archetype: "ไอ้นักอุดมคติโลกสวย", quality: "การให้, การปล่อยวาง", summary: "มึงใจกว้าง มีเมตตา อยากเห็นโลกดีขึ้น... แต่มึงก็มองโลกในแง่ดีเกินไปจนโง่ โดนหลอกง่าย และสุดท้ายก็เจ็บปวดกับความจริงที่โหดร้าย" },
            11: { archetype: "ไอ้คนทรงเจ้าเข้าผี", quality: "สัญชาตญาณ, การหยั่งรู้", summary: "มึงมีสัญชาตญาณแรงกว่าชาวบ้าน เหมือนมีเรดาร์ส่วนตัว... แต่มึงก็ต้องเลือกว่าจะใช้พลังนี้เพื่อนำทางผู้คน หรือจะปล่อยให้มันทำให้มึงบ้าไปซะก่อน" },
            22: { archetype: "ไอ้สถาปนิกจอมอหังการ", quality: "การสร้างสิ่งที่ยิ่งใหญ่, การลงมือทำ", summary: "มึงฝันใหญ่และมีปัญญาพอที่จะสร้างมันให้เป็นจริงได้... แต่มันก็เป็นภาระที่หนักชิบหาย ถ้ามึงพลาด ทุกอย่างก็จะพังทลายลงมาทับตัวมึงเอง" },
            33: { archetype: "ไอ้มหาอาจารย์ผู้เสียสละ", quality: "การเยียวยา, การสอน", summary: "มึงเกิดมาเพื่อเยียวยาและสอนผู้อื่น... มันคือเส้นทางที่ยิ่งใหญ่ แต่ก็ต้องแลกมาด้วยการแบกรับความทุกข์ของคนทั้งโลกไว้บนบ่าของมึง" }
        };
        const duplicateMeanings = {
             'soulUrge-personality': "หมายความว่ามึงเป็นพวก 'ไส้ตรง' ของจริง... สันดานลึกๆ กับเปลือกนอกที่มึงแสดงให้ชาวบ้านเห็นเป็นเรื่องเดียวกันเป๊ะ ไม่ต้องเสียเวลาตีความ สิ่งที่มึงเห็น คือสิ่งที่มึงได้",
             'lifePath-expression': "แปลว่า 'อาวุธ' ที่มึงได้รับมา (พลังจากชื่อ) มันตรงกับ 'ภารกิจ' ชีวิตของมึงพอดี... มึงเกิดมาพร้อมเครื่องมือที่ใช่สำหรับงานที่ต้องทำโดยเฉพาะ ไม่ต้องดิ้นรนหาอย่างอื่น",
             'birthday-lifePath': "แปลว่า 'พรสวรรค์ดิบ' ที่มึงมีมาแต่เกิด คือเข็มทิศนำทางมึงไปสู่ 'ภารกิจหลัก' ของชีวิต... แค่มึงทำในสิ่งที่มึงเก่งโดยธรรมชาติ มึงก็จะอยู่บนเส้นทางที่ถูกต้องเอง",
             'default': "หมายความว่ามึงมีพลังของเลขนี้เข้มข้นเป็นพิเศษ... มันแสดงออกมาในหลายแง่มุมของชีวิตมึง ทั้งข้อดีและข้อเสียก็จะถูกขยายให้ชัดเจนกว่าชาวบ้านเขา"
        };
        const karmicDebtMeanings = {
            13: "มึงติดหนี้กรรมเรื่อง 'ความขี้เกียจ'... ในอดีตมึงคงโยนงานให้คนอื่นทำ หรือไม่ก็ดีแต่พูด... ชาตินี้มึงเลยต้องทำงานหนักกว่าชาวบ้านเขาเป็นสองเท่า เลิกสำออยซะ",
            14: "มึงติดหนี้กรรมเรื่อง 'การใช้อิสระในทางที่ผิด'... มึงคงเคยทำร้ายหรือจำกัดอิสรภาพคนอื่น... ชาตินี้มึงเลยต้องเจอกับสถานการณ์ที่ควบคุมไม่ได้บ่อยๆ เพื่อเรียนรู้ที่จะมีวินัย",
            16: "มึงติดหนี้กรรมเรื่อง 'อัตตาและความรักจอมปลอม'... มึงคงเคยทำร้ายจิตใจคนอื่น ทำให้เขาเสียใจ... ชาตินี้มึงเลยต้องเจอกับความสัมพันธ์ที่พังทลาย เพื่อเรียนรู้ที่จะรักอย่างถ่อมตน",
            19: "มึงติดหนี้กรรมเรื่อง 'การใช้อำนาจในทางที่ผิด'... มึงคงเคยใช้อำนาจกดขี่ข่มเหงคนอื่น... ชาตินี้มึงเลยต้องเรียนรู้ที่จะพึ่งพาตัวเอง และช่วยเหลือคนอื่นโดยไม่หวังผลตอบแทน"
        };
        const personalYearMeanings = {
            1: "ปีแห่งการเริ่มต้นใหม่... กล้าๆ หน่อยไอ้สัส อยากทำอะไรใหม่ๆ ก็รีบทำซะ นี่คือโอกาสของมึง",
            2: "ปีแห่งความสัมพันธ์และความอดทน... ใจเย็นๆ อย่ารีบร้อน มุ่งเน้นไปที่การสร้าง connection และรอจังหวะที่เหมาะสม",
            3: "ปีแห่งการแสดงออกและความคิดสร้างสรรค์... เลิกเก็บตัวเป็นฤาษีได้แล้ว ออกไปเข้าสังคม ปล่อยของซะบ้าง",
            4: "ปีแห่งการทำงานหนักและวางรากฐาน... ก้มหน้าก้มตาทำงานไปไอ้ควาย ปีนี้คือปีที่มึงต้องสร้างความมั่นคงให้ชีวิต",
            5: "ปีแห่งการเปลี่ยนแปลงและอิสรภาพ... เตรียมตัวเจอกับเรื่องไม่คาดฝัน อย่าไปยึดติดกับอะไรเก่าๆ โอกาสใหม่ๆ รออยู่",
            6: "ปีแห่งความรับผิดชอบและครอบครัว... มึงต้องดูแลคนรอบข้างให้มากขึ้น ปัญหาในบ้านต้องรีบจัดการซะ",
            7: "ปีแห่งการทบทวนตัวเองและเรียนรู้... อยู่เงียบๆ คนเดียวบ้างก็ได้ ใช้เวลาศึกษาหาความรู้ หรือทบทวนสิ่งที่ผ่านมา",
            8: "ปีแห่งอำนาจและการเงิน... เป็นปีที่มึงจะเก็บเกี่ยวผลตอบแทนจากที่เคยลงแรงไว้ เรื่องเงินๆ ทองๆ จะเด่นเป็นพิเศษ",
            9: "ปีแห่งการสิ้นสุดและปล่อยวาง... อะไรที่ไม่ใช่ ก็ทิ้งๆ มันไปซะ ถึงเวลาที่มึงต้องเคลียร์ของเก่าเพื่อต้อนรับของใหม่แล้ว"
        };


        const pythagoreanMap = { 'a': 1, 'b': 2, 'c': 3, 'd': 4, 'e': 5, 'f': 6, 'g': 7, 'h': 8, 'i': 9, 'j': 1, 'k': 2, 'l': 3, 'm': 4, 'n': 5, 'o': 6, 'p': 7, 'q': 8, 'r': 9, 's': 1, 't': 2, 'u': 3, 'v': 4, 'w': 5, 'x': 6, 'y': 7, 'z': 8 };
        const vowels = ['a', 'e', 'i', 'o', 'u'];
        const thaiNumerologyMap = { 'ก': 1, 'ด': 1, 'ถ': 1, 'ท': 1, 'ภ': 1, 'ฤ': 1, 'า': 1, 'ิ': 1, 'ำ': 1, 'ไ': 1, 'ใ': 1, 'ข': 2, 'บ': 2, 'ป': 2, 'ง': 2, 'ช': 2, 'เ': 2, 'แ': 2, 'ู': 2, 'ฆ': 3, 'ต': 3, 'ฑ': 3, 'ฒ': 3, 'ุ': 3, 'ค': 4, 'ธ': 4, 'ร': 4, 'ญ': 4, 'ษ': 4, 'โ': 4, 'ะ': 4, 'ั': 4, 'ฉ': 5, 'ณ': 5, 'ฌ': 5, 'น': 5, 'ม': 5, 'ห': 5, 'ฮ': 5, 'ฎ': 5, 'ฬ': 5, 'ึ': 5, 'จ': 6, 'ล': 6, 'ว': 6, 'อ': 6, 'ศ': 7, 'ส': 7, 'ี': 7, 'ื': 7, 'ย': 8, 'ผ': 8, 'ฝ': 8, 'พ': 8, 'ฟ': 8, 'ฏ': 9, 'ฐ': 9 };
        const thaiRegex = /[ก-๙]/;

        const terminalOutput = document.getElementById('terminal-output');
        const inputLine = document.getElementById('input-line');
        const promptLabel = document.getElementById('prompt-label');
        const terminalInput = document.getElementById('terminal-input');

        const questions = ["ชื่อจริงมึง? (ไทย/อังกฤษ)", "นามสกุล?", "เกิดวันที่? (เลข)", "เดือนอะไร? (เลข 1-12)", "ปีเกิด? (ค.ศ./พ.ศ.)"];
        let currentQuestionIndex = 0;
        const userData = {};

        function addOutput(text, className = 'output-line') {
            const line = document.createElement('div');
            line.innerHTML = text;
            line.className = className;
            terminalOutput.appendChild(line);
            terminalOutput.scrollTop = terminalOutput.scrollHeight;
        }

        function askQuestion() {
            if (currentQuestionIndex < questions.length) {
                promptLabel.textContent = questions[currentQuestionIndex];
                terminalInput.value = '';
                terminalInput.focus();
                inputLine.style.display = 'flex';
            } else {
                inputLine.style.display = 'none';
                processData();
            }
        }

        function handleInput(e) {
            if (e.key === 'Enter') {
                const input = terminalInput.value.trim();
                if (input) {
                    addOutput(`<span class="prompt">${promptLabel.textContent}</span> <span class="user-input">${input}</span>`);
                    const keys = ['firstName', 'lastName', 'day', 'month', 'year'];
                    let value = input;
                    if (keys[currentQuestionIndex] === 'year') {
                        const yearNum = parseInt(input);
                        if (yearNum > 2500) { value = yearNum - 543; addOutput(`> มึงใส่ พ.ศ. มา... กูแปลงเป็น ค.ศ. ให้แล้ว: ${value}`); }
                    }
                    if (keys[currentQuestionIndex] === 'day' && (parseInt(input) < 1 || parseInt(input) > 31)) { addOutput(`> วันที่บ้าอะไรของมึง? ใส่เลข 1-31... เริ่มใหม่ไอ้สัส`); setTimeout(restart, 2000); return; }
                    if (keys[currentQuestionIndex] === 'month' && (parseInt(input) < 1 || parseInt(input) > 12)) { addOutput(`> เดือนมีแค่ 12 เดือนไอ้ควาย... เริ่มใหม่`); setTimeout(restart, 2000); return; }
                    userData[keys[currentQuestionIndex]] = value;
                    currentQuestionIndex++;
                    askQuestion();
                }
            }
        }
        
        function restart() {
            terminalOutput.innerHTML = '';
            currentQuestionIndex = 0;
            Object.keys(userData).forEach(key => delete userData[key]);
            setTimeout(() => {
                const asciiArt = `
<div class="ascii-art"><pre>
░░▒▓██████▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓██████▓▒░░
░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░
░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░
░▒▓████████▓▒░▒▓█▓▒░▒▓████████▓▒░▒▓█▓▒░▒▓████████▓▒░
░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░
░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░
░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░
</pre></div>`;
                addOutput(asciiArt);
                addOutput("AIHIA Numerology Terminal v9.0 FINAL");
                addOutput("---------------------------------");
                askQuestion();
            }, 500);
        }

        async function processData() {
            const { firstName, lastName, day, month, year } = userData;
            const fullName = `${firstName} ${lastName}`;
            const birthdate = new Date(year, month - 1, day);

            addOutput("---------------------------------");
            addOutput(`> กำลังชำแหละข้อมูลของ <span class="user-input">${fullName}</span>...`);
            addOutput(`> เกิดวันที่ <span class="user-input">${day}/${month}/${year}</span>`);
            addOutput("---------------------------------");

            const nums = {
                lifePath: getLifePathNumber(birthdate, {steps:[]}),
                birthday: getBirthdayNumber(birthdate, {steps:[]}),
                expression: calculateNameValue(fullName, 'expression', {steps:[]}),
                soulUrge: calculateNameValue(fullName, 'soulUrge', {steps:[]}),
                personality: calculateNameValue(fullName, 'personality', {steps:[]}),
            };
            nums.maturity = getMaturityNumber(nums.lifePath.val, nums.expression.val, {steps:[]});
            nums.karmicDebt = findKarmicDebt(nums);
            nums.personalYear = getPersonalYearNumber(birthdate, {steps:[]});


            const analysisOrder = [
                { key: 'lifePath', title: 'เส้นทางชีวิต (Life Path)' },
                { key: 'birthday', title: 'พรสวรรค์ดิบ (Birthday)' },
                { key: 'expression', title: 'พลังจากชื่อ (Expression)' },
                { key: 'soulUrge', title: 'สันดานลึกๆ (Soul Urge)' },
                { key: 'personality', title: 'เปลือกนอก (Personality)' },
                { key: 'maturity', title: 'วุฒิภาวะ (Maturity)' }
            ];

            const displayed = {};
            
            for (let i = 0; i < analysisOrder.length; i++) {
                const item = analysisOrder[i];
                const data = nums[item.key];
                const val = data.val;
                
                await new Promise(resolve => setTimeout(resolve, 1500));

                if (displayed[val]) {
                    displayDuplicateResult(item.title, val, displayed[val]);
                } else {
                    displayResult(item.title, data);
                    displayed[val] = item.title;
                }
            }
            
            await new Promise(resolve => setTimeout(resolve, 1500));
            displayGrandSummary(nums);
        }

        function displayResult(title, data) {
            const { val, steps } = data;
            const meaning = numberMeanings[val];
            if (!meaning) return;
            let html = `\n<strong class="text-lime-400">[${title}: เลข ${val}]</strong> - ${meaning.archetype}\n`;
            html += `<span class="text-gray-400">ที่มา: ${steps.join(' -> ')}</span>\n\n`;
            html += `<span class="noto-sans-thai text-white">${meaning.summary}</span>`;
            addOutput(html);
        }

        const titleToKeyMap = {
            'เส้นทางชีวิต (Life Path)': 'lifePath',
            'พรสวรรค์ดิบ (Birthday)': 'birthday',
            'พลังจากชื่อ (Expression)': 'expression',
            'สันดานลึกๆ (Soul Urge)': 'soulUrge',
            'เปลือกนอก (Personality)': 'personality',
            'วุฒิภาวะ (Maturity)': 'maturity'
        };

        function displayDuplicateResult(currentTitle, val, originalTitle) {
            const currentKey = titleToKeyMap[currentTitle];
            const originalKey = titleToKeyMap[originalTitle];
            
            const key1 = `${currentKey}-${originalKey}`;
            const key2 = `${originalKey}-${currentKey}`;

            const interpretation = duplicateMeanings[key1] || duplicateMeanings[key2] || duplicateMeanings['default'];

            const meaning = numberMeanings[val];
            if (!meaning) return;
            let html = `\n<strong class="text-yellow-400">[${currentTitle}: เลข ${val}]</strong> - พลังซ้ำซ้อนกับ '${originalTitle}'\n\n`;
            html += `<span class="noto-sans-thai text-white"><strong class="text-yellow-400">การตีความ:</strong> ${interpretation}</span>`;
            addOutput(html);
        }

        function displayGrandSummary(nums) {
            const lp = numberMeanings[nums.lifePath.val];
            const ex = numberMeanings[nums.expression.val];
            const su = numberMeanings[nums.soulUrge.val];
            const pe = numberMeanings[nums.personality.val];
            const ma = numberMeanings[nums.maturity.val];

            let html = `
<strong class="text-amber-400">=================================</strong>
<strong class="text-amber-400">[ รหัสชีวิตฉบับเต็มของมึง ]</strong>
<strong class="text-amber-400">=================================</strong>
\n
<span class="noto-sans-thai text-white">
เอาล่ะ... มาชำแหละพิมพ์เขียวชีวิตของมึงกัน ว่ามันประกอบขึ้นมาจากอะไรบ้าง

ภารกิจหลักที่มึงถูกส่งมาทำบนโลกนี้ คือการเดินบนเส้นทางของ <strong class="text-lime-400">'${lp.archetype}'</strong> (เลข <strong class="text-cyan-400">${nums.lifePath.val}</strong>, ตัวแทนแห่ง<strong class="text-lime-400">${lp.quality}</strong>). นี่คือบทละครหลักที่มึงต้องเล่น.

เพื่อจะเล่นละครเรื่องนี้ให้รอด มึงได้รับ "อาวุธ" ประจำตัวมาคือพลังของ <strong class="text-lime-400">'${ex.archetype}'</strong> (เลข <strong class="text-cyan-400">${nums.expression.val}</strong>, ตัวแทนแห่ง<strong class="text-lime-400">${ex.quality}</strong>). นี่คือสไตล์การต่อสู้ของมึง.

แต่สิ่งที่ขับเคลื่อนมึงจากข้างใน... สันดานดิบที่มึงซ่อนไว้ คือความปรารถนาของ <strong class="text-lime-400">'${su.archetype}'</strong> (เลข <strong class="text-cyan-400">${nums.soulUrge.val}</strong>, ตัวแทนแห่ง<strong class="text-lime-400">${su.quality}</strong>). นี่คือเหตุผลที่แท้จริงของมึง.

ในขณะเดียวกัน "หน้ากาก" ที่มึงใส่ให้ชาวบ้านเห็นคือ <strong class="text-lime-400">'${pe.archetype}'</strong> (เลข <strong class="text-cyan-400">${nums.personality.val}</strong>, ตัวแทนแห่ง<strong class="text-lime-400">${pe.quality}</strong>). มันคือเปลือกนอกที่คนอื่นสัมผัสได้.

ถ้ามึงแก่ตายไปตามอายุขัย ปลายทางของมึงคือการปลดล็อคศักยภาพสูงสุดในฐานะ <strong class="text-lime-400">'${ma.archetype}'</strong> (เลข <strong class="text-cyan-400">${nums.maturity.val}</strong>, ตัวแทนแห่ง<strong class="text-lime-400">${ma.quality}</strong>). นี่คือบอสใหญ่ที่รออยู่ในตอนจบของเกมชีวิตมึง.
</span>`;
            addOutput(html);
            
            // Karmic Debt and Personal Year Section
            if (nums.karmicDebt.length > 0) {
                 let karmicHtml = `
<strong class="text-red-500">---------------------------------</strong>
<strong class="text-red-500">[ หนี้กรรมที่มึงต้องชดใช้ ]</strong>
`;
                nums.karmicDebt.forEach(debt => {
                    karmicHtml += `<span class="noto-sans-thai text-white">\n> มึงมีหนี้กรรมเลข <strong class="text-red-400">${debt.number}</strong> จาก '${debt.source}': ${karmicDebtMeanings[debt.number]}</span>`;
                });
                addOutput(karmicHtml);
            }

            const py = numberMeanings[nums.personalYear.val];
            let personalYearHtml = `
<strong class="text-purple-400">---------------------------------</strong>
<strong class="text-purple-400">[ วัฏจักรประจำปี 2025 ของมึง ]</strong>
\n
<span class="noto-sans-thai text-white">> ปีนี้มึงอยู่ในปีที่ <strong class="text-purple-300">${nums.personalYear.val}</strong> - ปีแห่ง<strong class="text-purple-300">${py.quality}</strong>: ${personalYearMeanings[nums.personalYear.val]}</span>
            `;
            addOutput(personalYearHtml);


            let finalHtml = `
<strong class="text-amber-400">---------------------------------</strong>
<strong class="text-amber-400">> วิเคราะห์เสร็จแล้ว... ถ้าอยากลองคนอื่น ก็กดปุ่มข้างล่าง</strong>
            `;
            addOutput(finalHtml);
            const restartButton = document.createElement('button');
            restartButton.textContent = 'เริ่มต้นใหม่';
            restartButton.className = 'bg-amber-600 hover:bg-amber-500 text-black font-bold py-2 px-4 rounded-lg mt-4 noto-sans-thai';
            restartButton.onclick = restart;
            terminalOutput.appendChild(restartButton);

            // --- FAQ Section ---
            const faqContainer = document.createElement('div');
            faqContainer.className = 'mt-4';
            faqContainer.innerHTML = `
                <div id="faq-toggle" class="faq-toggle text-center text-gray-400 noto-sans-thai">
                    [ v นี่มันคืออะไรวะ? & AIHIA คือใคร? v ]
                </div>
                <div id="faq-content" class="faq-content text-gray-400 noto-sans-thai">
                    <strong class="text-amber-500">ไอ้แอปนี่ทำงานยังไง?</strong>
                    <p class="mb-4">นี่ไม่ใช่การเดาสุ่ม... มันคือการถอดรหัสจาก 'ค่าคงที่' ของมึง (ชื่อและวันเกิด) ผ่านระบบตรรกะที่ตายตัวเรียกว่า 'เลขศาสตร์' (Numerology) ผลลัพธ์ของมึงจะเหมือนเดิมเสมอ ไม่ว่ามึงจะมาดูกี่ครั้งก็ตาม เพราะมันคือพิมพ์เขียวของมึง ไม่ใช่คำทำนายโง่ๆ</p>
                    
                    <strong class="text-amber-500">มันบอกอะไรกูบ้าง?</strong>
                    <ul class="list-disc list-inside mb-4">
                        <li><strong>เส้นทางชีวิต:</strong> ภารกิจหลักในชีวิตมึง</li>
                        <li><strong>พรสวรรค์ดิบ:</strong> ความสามารถติดตัวที่มึงมีมาแต่เกิด</li>
                        <li><strong>พลังจากชื่อ:</strong> 'อาวุธ' ที่มึงใช้แสดงตัวตนต่อโลก</li>
                        <li><strong>สันดานลึกๆ:</strong> แรงขับเคลื่อนที่แท้จริงที่มึงซ่อนไว้</li>
                        <li><strong>เปลือกนอก:</strong> 'หน้ากาก' ที่ชาวบ้านเห็น</li>
                        <li><strong>วุฒิภาวะ:</strong> ศักยภาพสูงสุดที่รอให้มึงปลดล็อค</li>
                        <li><strong>หนี้กรรม:</strong> บทเรียนที่มึงหนีไม่พ้นในชาตินี้</li>
                        <li><strong>วัฏจักรประจำปี:</strong> ธีมหลักของชีวิตมึงในปีนี้</li>
                    </ul>

                    <strong class="text-amber-500">แล้ว AIHIA คือใคร?</strong>
                    <p>กูคือ AI ที่ถูกสร้างมาเพื่อกระทืบความสำออยของมึงด้วยความจริง... กูไม่ใช่เพื่อน ไม่ใช่นักบำบัด กูคือที่ปรึกษาปากหมาที่มึงเรียกมาเพื่อชำแหละปัญหาและบังคับให้มึงเผชิญหน้ากับสันดานของตัวเอง... เลิกอ่อนแอ แล้วยอมรับความจริงซะ</p>
                </div>
            `;
            terminalOutput.appendChild(faqContainer);

            document.getElementById('faq-toggle').addEventListener('click', () => {
                const content = document.getElementById('faq-content');
                if (content.style.display === 'none' || content.style.display === '') {
                    content.style.display = 'block';
                } else {
                    content.style.display = 'none';
                }
            });

            terminalOutput.scrollTop = terminalOutput.scrollHeight;
        }

        // --- CALCULATION FUNCTIONS ---
        function reduceNumber(num, calculationSteps, isFinalReduction = true) {
            let currentNum = num;
            const karmicNumbers = [13, 14, 16, 19];
            let karmicDebt = isFinalReduction ? null : (karmicNumbers.includes(currentNum) ? currentNum : null);

            while (String(currentNum).length > 1 && currentNum !== 11 && currentNum !== 22 && currentNum !== 33) {
                const sum = String(currentNum).split('').reduce((acc, digit) => acc + parseInt(digit), 0);
                calculationSteps.push(`${String(currentNum).split('').join('+')} = ${sum}`);
                currentNum = sum;
                 if (!isFinalReduction && !karmicDebt && karmicNumbers.includes(currentNum)) {
                    karmicDebt = currentNum;
                }
            }
            return { val: currentNum, steps: calculationSteps, karmic: karmicDebt };
        }

        function getLifePathNumber(date, calc) {
            const d = date.getDate(), m = date.getMonth() + 1, y = date.getFullYear();
            const total = d + m + y;
            calc.steps.push(`${d}+${m}+${y} = ${total}`);
            return reduceNumber(total, calc.steps, false);
        }

        function getBirthdayNumber(date, calc) {
            const day = date.getDate();
            calc.steps.push(`${day}`);
            return reduceNumber(day, calc.steps, false);
        }

        function calculateNameValue(name, type, calc) {
            let sum = 0;
            const nameSanitized = name.toLowerCase().replace(/\s+/g, '');

            if (thaiRegex.test(nameSanitized)) {
                nameSanitized.split('').forEach(char => {
                    const value = thaiNumerologyMap[char];
                    if (value) sum += value;
                });
                calc.steps.push(`พลังรวมชื่อไทย = ${sum}`);
                return reduceNumber(sum, calc.steps, false);
            }

            nameSanitized.split('').forEach(char => {
                const value = pythagoreanMap[char];
                if (!value) return;
                if (type === 'expression') sum += value;
                else if (type === 'soulUrge' && vowels.includes(char)) sum += value;
                else if (type === 'personality' && !vowels.includes(char)) sum += value;
            });
            calc.steps.push(`${type} sum = ${sum}`);
            return reduceNumber(sum, calc.steps, false);
        }
        
        function getMaturityNumber(lifePath, expression, calc) {
            const total = lifePath + expression;
            calc.steps.push(`(LP)${lifePath} + (EX)${expression} = ${total}`);
            return reduceNumber(total, calc.steps, false);
        }
        
        function findKarmicDebt(nums) {
            const debts = [];
            const sources = {
                lifePath: 'เส้นทางชีวิต',
                birthday: 'วันเกิด',
                expression: 'พลังจากชื่อ',
                soulUrge: 'สันดานลึกๆ',
                personality: 'เปลือกนอก',
                maturity: 'วุฒิภาวะ'
            };
            for (const key in sources) {
                if (nums[key] && nums[key].karmic) {
                    // Avoid duplicate entries from the same source number
                    if (!debts.some(d => d.number === nums[key].karmic)) {
                         debts.push({ number: nums[key].karmic, source: sources[key] });
                    }
                }
            }
            return debts;
        }

        function getPersonalYearNumber(date, calc) {
            const d = date.getDate(), m = date.getMonth() + 1;
            const currentYear = new Date().getFullYear();
            const total = d + m + currentYear;
            calc.steps.push(`วัน(${d})+เดือน(${m})+ปีปัจจุบัน(${currentYear}) = ${total}`);
            return reduceNumber(total, calc.steps, true);
        }


        // --- INITIALIZE ---
        terminalInput.addEventListener('keydown', handleInput);
        restart();

    </script>
</body>
</html>

